define(["l/jquery","l/mustache","c/tpl"],function(_,mustache,tpl){var Dialog=function(opts){var dopts={top:void 0,left:void 0,autoHide:void 0,title:"提示",frameTPL:tpl.dialogTPL,content:"",showClose:!0};return opts=_.extend(dopts,opts),this._opts=opts,this._ready(),this._constructFrame(),YYMG._tp.dialog=this};return Dialog.prototype._ready=function(){var dialog=YYMG._tp.dialog;dialog&&dialog.close(),this._dialogEl=document.createElement("div"),this._dialogEl.className="dialog"},Dialog.prototype._constructFrame=function(){var opts=this._opts,dialogEl=_(this._dialogEl),frameHTML=mustache.render(opts.frameTPL,{title:opts.title,content:opts.content});dialogEl.html(frameHTML),_(document.body).append(dialogEl),this.resetPos(),this._footerEl=dialogEl.find(".dialog-footer");var close=this._closeEl=dialogEl.find(".close"),self=this;opts.showClose?close.bind("click",function(){self.close()}):close.remove();var ah=opts.autoHide;ah&&"number"==typeof ah&&window.setTimeout(function(){self.close()},1e3*ah)},Dialog.prototype.setWidth=function(){return this},Dialog.prototype.setContent=function(){return this},Dialog.prototype.addButton=function(){var button=document.createElement("a");if(button.className="button",button.href="javascript:;","function"==typeof callback){var self=this;button.bind("click",function(){callback.call(self)})}return this._footerEl.append(button),this},Dialog.prototype.resetPos=function(){var dialogEl=_(this._dialogEl),_diaW=dialogEl.css("width"),_diaH=dialogEl.css("height"),vp=_(window),left=this._opts.left||(vp.width()-parseInt(_diaW))/2,top=this._opts.top||vp.scrollTop()+(vp.height()-parseInt(_diaH))/2;return dialogEl.css({top:top+"px",left:left+"px"}),this},Dialog.prototype.close=function(){_(this._dialogEl).remove(),YYMG._tp.dialog=null},{Dialog:Dialog}});