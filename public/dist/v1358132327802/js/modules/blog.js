define(function(e,t){var n=e("../common/interface");dialog=e("../common/components").dialog,tpl=e("../common/tpl");var r=new Template(tpl.commentTPL);t.init=function(){var e=$("respond"),t=$("comment-list");Event.observe(e,"click",function(e){var i=Element.extend(this),o=Element.extend(e.target);if("submit"==o.className){var s=i.select(".author")[0],a=i.select(".mail")[0],u=i.select(".webside")[0],l=i.select(".comment")[0];new Ajax.Request(n.ADD_COMMENT,{parameters:"author="+s.value+"&mail="+a.value+"&webside="+u.value+"&comment="+l.value+"&postId="+YYMG.pid,onSuccess:function(e){var e=e.responseText.evalJSON();if(1==e.status.code)if(e.data.isApproved){var n=new Date(e.data.time),i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Spt","Oct","Nov","Dec"],o={pid:YYMG.pid,author:s.value,comment:l.value.escapeHTML(),month:i[n.getMonth()],date:n.getDate(),year:n.getFullYear(),hour:n.getHours(),minute:n.getMinutes()},a=r.evaluate(o);t?t.insert(a):location.reload()}else new dialog({type:"inform",content:"评论成功！需呀管理员审核才能显示。"});else new dialog({content:e.status.content})},onFailure:function(){new dialog({type:"error",content:""})}})}})},t.listInit=Prototype.emptyFunction});